<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 Week 5 : Studying spatial point patterns | Crime Mapping in R</title>
  <meta name="description" content="Worksheets for labs of Crime Mapping course">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 Week 5 : Studying spatial point patterns | Crime Mapping in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Worksheets for labs of Crime Mapping course" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Week 5 : Studying spatial point patterns | Crime Mapping in R" />
  
  <meta name="twitter:description" content="Worksheets for labs of Crime Mapping course" />
  

<meta name="author" content="Juanjo Medina and Reka Solymosi">


<meta name="date" content="2019-02-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="week-4-performing-spatial-operations-in-r.html">
<link rel="next" href="week-6-spatial-autocorrelation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Crime mapping in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prelude</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>0.1</b> Introduction</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>0.2</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html"><i class="fa fa-check"></i><b>1</b> A first lesson about R (Week 1)</a><ul>
<li class="chapter" data-level="1.1" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#install-r-rstudio"><i class="fa fa-check"></i><b>1.1</b> Install R &amp; RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#open-up-and-explore-rstudio"><i class="fa fa-check"></i><b>1.2</b> Open up and explore RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#customising-the-rstudio-look"><i class="fa fa-check"></i><b>1.3</b> Customising the RStudio look</a></li>
<li class="chapter" data-level="1.4" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#getting-organised-r-projects"><i class="fa fa-check"></i><b>1.4</b> Getting organised: R Projects</a></li>
<li class="chapter" data-level="1.5" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#talk-to-your-computer"><i class="fa fa-check"></i><b>1.5</b> Talk to your computer</a></li>
<li class="chapter" data-level="1.6" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#more-on-packages"><i class="fa fa-check"></i><b>1.6</b> More on packages</a></li>
<li class="chapter" data-level="1.7" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#using-objects"><i class="fa fa-check"></i><b>1.7</b> Using objects</a></li>
<li class="chapter" data-level="1.8" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#more-on-objects"><i class="fa fa-check"></i><b>1.8</b> More on objects</a></li>
<li class="chapter" data-level="1.9" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#vectors"><i class="fa fa-check"></i><b>1.9</b> Vectors</a></li>
<li class="chapter" data-level="1.10" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#on-comments"><i class="fa fa-check"></i><b>1.10</b> On comments</a></li>
<li class="chapter" data-level="1.11" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#factors"><i class="fa fa-check"></i><b>1.11</b> Factors</a></li>
<li class="chapter" data-level="1.12" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#naming-conventions-for-objects-in-r"><i class="fa fa-check"></i><b>1.12</b> Naming conventions for objects in R</a></li>
<li class="chapter" data-level="1.13" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#dataframes"><i class="fa fa-check"></i><b>1.13</b> Dataframes</a></li>
<li class="chapter" data-level="1.14" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#exploring-data"><i class="fa fa-check"></i><b>1.14</b> Exploring data</a></li>
<li class="chapter" data-level="1.15" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#quitting-rstudio"><i class="fa fa-check"></i><b>1.15</b> Quitting RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html"><i class="fa fa-check"></i><b>2</b> Week 2: Making your first maps in R</a><ul>
<li class="chapter" data-level="2.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#a-quick-introduction-of-terms"><i class="fa fa-check"></i><b>2.1</b> A quick introduction of terms</a><ul>
<li class="chapter" data-level="2.1.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#geospatial-perspective---the-basics"><i class="fa fa-check"></i><b>2.1.1</b> Geospatial Perspective - The Basics</a></li>
<li class="chapter" data-level="2.1.2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#summary"><i class="fa fa-check"></i><b>2.1.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#getting-some-spatial-data-to-put-on-a-map"><i class="fa fa-check"></i><b>2.2</b> Getting some spatial data to put on a map</a><ul>
<li class="chapter" data-level="2.2.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#a-first-look-at-basemaps"><i class="fa fa-check"></i><b>2.2.1</b> A first look at basemaps</a></li>
<li class="chapter" data-level="2.2.2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#find-some-relevant-data-to-show-obtaining-data-on-crime"><i class="fa fa-check"></i><b>2.2.2</b> Find some relevant data to show: obtaining data on crime</a></li>
<li class="chapter" data-level="2.2.3" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#add-a-point-layer-to-your-basemap"><i class="fa fa-check"></i><b>2.2.3</b> Add a point layer to your basemap</a></li>
<li class="chapter" data-level="2.2.4" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#homework-1"><i class="fa fa-check"></i><b>2.2.4</b> HOMEWORK 1</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#from-dataframes-to-spatial-objects-finding-shapefiles"><i class="fa fa-check"></i><b>2.3</b> From dataframes to spatial objects: finding shapefiles</a></li>
<li class="chapter" data-level="2.4" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#reading-shapefiles-into-r-the-wonderful-world-of-sf-objects"><i class="fa fa-check"></i><b>2.4</b> Reading shapefiles into R: the wonderful world of sf objects</a><ul>
<li class="chapter" data-level="2.4.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#homework-2"><i class="fa fa-check"></i><b>2.4.1</b> <strong>HOMEWORK 2</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#add-some-data"><i class="fa fa-check"></i><b>2.5</b> Add some data</a><ul>
<li class="chapter" data-level="2.5.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>2.5.1</b> Data wrangling with dplyr</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#join-data-to-spatial-object"><i class="fa fa-check"></i><b>2.6</b> Join data to spatial object</a></li>
<li class="chapter" data-level="2.7" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#so-left_join-eh"><i class="fa fa-check"></i><b>2.7</b> So left_join(), eh?</a></li>
<li class="chapter" data-level="2.8" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#lets-make-this-prettier-a-quick-glance-at-tmap"><i class="fa fa-check"></i><b>2.8</b> Let’s make this prettier: a quick glance at tmap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html"><i class="fa fa-check"></i><b>3</b> Week 3: Thematic maps in R</a><ul>
<li class="chapter" data-level="3.1" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#intro-and-recap"><i class="fa fa-check"></i><b>3.1</b> Intro and recap</a></li>
<li class="chapter" data-level="3.2" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#creating-choropleth-maps"><i class="fa fa-check"></i><b>3.2</b> Creating choropleth maps</a></li>
<li class="chapter" data-level="3.3" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#producing-small-multiples-to-compare-the-effect-of-different-classification-systems"><i class="fa fa-check"></i><b>3.3</b> Producing small multiples to compare the effect of different classification systems</a><ul>
<li class="chapter" data-level="3.3.1" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#homework-1-1"><i class="fa fa-check"></i><b>3.3.1</b> Homework 1</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#using-graduated-symbols"><i class="fa fa-check"></i><b>3.4</b> Using graduated symbols</a></li>
<li class="chapter" data-level="3.5" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#bringing-additional-census-data-in"><i class="fa fa-check"></i><b>3.5</b> Bringing additional census data in</a></li>
<li class="chapter" data-level="3.6" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#computing-and-mapping-crime-rates"><i class="fa fa-check"></i><b>3.6</b> Computing and mapping crime rates</a><ul>
<li class="chapter" data-level="3.6.1" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#homework-2-1"><i class="fa fa-check"></i><b>3.6.1</b> Homework 2</a></li>
<li class="chapter" data-level="3.6.2" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#homework-3"><i class="fa fa-check"></i><b>3.6.2</b> Homework 3</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#more-on-small-multiples-and-point-pattern-maps"><i class="fa fa-check"></i><b>3.7</b> More on small multiples and point pattern maps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html"><i class="fa fa-check"></i><b>4</b> Week 4: Performing spatial operations in R</a><ul>
<li class="chapter" data-level="4.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#getting-some-more-data"><i class="fa fa-check"></i><b>4.1</b> Getting some (more) data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#reading-data-in-from-the-web"><i class="fa fa-check"></i><b>4.1.1</b> Reading data in from the web</a></li>
<li class="chapter" data-level="4.1.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#subsetting-using-pattern-matching"><i class="fa fa-check"></i><b>4.1.2</b> Subsetting using pattern matching</a></li>
<li class="chapter" data-level="4.1.3" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#geocoding-from-an-address"><i class="fa fa-check"></i><b>4.1.3</b> Geocoding from an address</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#making-interactive-maps-with-leaflet"><i class="fa fa-check"></i><b>4.2</b> Making interactive maps with leaflet</a><ul>
<li class="chapter" data-level="4.2.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#making-a-map"><i class="fa fa-check"></i><b>4.2.1</b> Making a map</a></li>
<li class="chapter" data-level="4.2.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#adding-some-content"><i class="fa fa-check"></i><b>4.2.2</b> Adding some content:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#adding-points-manually"><i class="fa fa-check"></i><b>4.3</b> Adding points manually:</a><ul>
<li class="chapter" data-level="4.3.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#change-the-basemap"><i class="fa fa-check"></i><b>4.3.1</b> Change the basemap</a></li>
<li class="chapter" data-level="4.3.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#adding-data-from-elsewhere"><i class="fa fa-check"></i><b>4.3.2</b> Adding data from elsewhere</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#spatial-operations"><i class="fa fa-check"></i><b>4.4</b> Spatial operations</a><ul>
<li class="chapter" data-level="4.4.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#coordinate-reference-systems-revisited"><i class="fa fa-check"></i><b>4.4.1</b> Coordinate reference systems revisited</a></li>
<li class="chapter" data-level="4.4.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#meet-a-new-format-of-shapefile-geojson"><i class="fa fa-check"></i><b>4.4.2</b> Meet a new format of shapefile: geojson</a></li>
<li class="chapter" data-level="4.4.3" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#subset-points-to-those-within-a-polygon"><i class="fa fa-check"></i><b>4.4.3</b> Subset points to those within a polygon</a></li>
<li class="chapter" data-level="4.4.4" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#spatial-operations-two-building-buffers"><i class="fa fa-check"></i><b>4.4.4</b> Spatial operations two: building buffers</a></li>
<li class="chapter" data-level="4.4.5" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#points-in-polygon"><i class="fa fa-check"></i><b>4.4.5</b> Points in Polygon</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#recap"><i class="fa fa-check"></i><b>4.5</b> Recap</a></li>
<li class="chapter" data-level="4.6" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#homework"><i class="fa fa-check"></i><b>4.6</b> Homework</a><ul>
<li class="chapter" data-level="4.6.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#geocode-the-addresses"><i class="fa fa-check"></i><b>4.6.1</b> <strong>Geocode the addresses:</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html"><i class="fa fa-check"></i><b>5</b> Week 5 : Studying spatial point patterns</a><ul>
<li class="chapter" data-level="5.1" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#what-well-do-today"><i class="fa fa-check"></i><b>5.1</b> What we’ll do today</a></li>
<li class="chapter" data-level="5.2" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#getting-the-data"><i class="fa fa-check"></i><b>5.2</b> Getting the data</a></li>
<li class="chapter" data-level="5.3" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#getting-the-data-into-spatstat-the-problem-with-duplicates"><i class="fa fa-check"></i><b>5.3</b> Getting the data into spatstat: the problem with duplicates</a></li>
<li class="chapter" data-level="5.4" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#inspecting-our-data-with-spatstat"><i class="fa fa-check"></i><b>5.4</b> Inspecting our data with spatstat</a></li>
<li class="chapter" data-level="5.5" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#density-estimates"><i class="fa fa-check"></i><b>5.5</b> Density estimates</a></li>
<li class="chapter" data-level="5.6" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#adding-some-context"><i class="fa fa-check"></i><b>5.6</b> Adding some context</a><ul>
<li class="chapter" data-level="5.6.1" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#homework-1-2"><i class="fa fa-check"></i><b>5.6.1</b> Homework 1</a></li>
<li class="chapter" data-level="5.6.2" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#homework-2-2"><i class="fa fa-check"></i><b>5.6.2</b> Homework 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>6</b> Week 6 : Spatial autocorrelation</a><ul>
<li class="chapter" data-level="6.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#get-data"><i class="fa fa-check"></i><b>6.1</b> Get data</a></li>
<li class="chapter" data-level="6.2" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#what-is-a-neighbour"><i class="fa fa-check"></i><b>6.2</b> What is a neighbour?</a><ul>
<li class="chapter" data-level="6.2.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#homework-1-3"><i class="fa fa-check"></i><b>6.2.1</b> Homework 1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#creating-a-list-of-neighbours"><i class="fa fa-check"></i><b>6.3</b> Creating a list of neighbours</a></li>
<li class="chapter" data-level="6.4" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#generating-the-weight-matrix"><i class="fa fa-check"></i><b>6.4</b> Generating the weight matrix</a><ul>
<li class="chapter" data-level="6.4.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#homework-2-3"><i class="fa fa-check"></i><b>6.4.1</b> Homework 2</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#compute-morans-i"><i class="fa fa-check"></i><b>6.5</b> Compute Moran’s I</a><ul>
<li class="chapter" data-level="6.5.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#homework-3-optional-practice"><i class="fa fa-check"></i><b>6.5.1</b> Homework 3 (Optional Practice)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>7</b> Week 7 : Local spatial autocorrelation</a><ul>
<li class="chapter" data-level="7.1" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html#prelude-1"><i class="fa fa-check"></i><b>7.1</b> Prelude</a></li>
<li class="chapter" data-level="7.2" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html#get-data-and-built-the-weight-matrix"><i class="fa fa-check"></i><b>7.2</b> Get data and built the weight matrix</a></li>
<li class="chapter" data-level="7.3" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html#generating-and-visualising-the-lisa-measures"><i class="fa fa-check"></i><b>7.3</b> Generating and visualising the LISA measures</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html"><i class="fa fa-check"></i><b>8</b> # Week 8 : Regression analysis (a refresher)</a><ul>
<li class="chapter" data-level="8.1" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#motivating-regression"><i class="fa fa-check"></i><b>8.2</b> Motivating regression</a></li>
<li class="chapter" data-level="8.3" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>8.3</b> Fitting a simple regression model</a></li>
<li class="chapter" data-level="8.4" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#residuals-revisited-r-squared"><i class="fa fa-check"></i><b>8.4</b> Residuals revisited: R squared</a></li>
<li class="chapter" data-level="8.5" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#inference-with-regression"><i class="fa fa-check"></i><b>8.5</b> Inference with regression</a></li>
<li class="chapter" data-level="8.6" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#fitting-regression-with-categorical-predictors"><i class="fa fa-check"></i><b>8.6</b> Fitting regression with categorical predictors</a></li>
<li class="chapter" data-level="8.7" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#motivating-multiple-regression"><i class="fa fa-check"></i><b>8.7</b> Motivating multiple regression</a></li>
<li class="chapter" data-level="8.8" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#fitting-and-interpreting-a-multiple-regression-model"><i class="fa fa-check"></i><b>8.8</b> Fitting and interpreting a multiple regression model</a></li>
<li class="chapter" data-level="8.9" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#presenting-your-regression-results."><i class="fa fa-check"></i><b>8.9</b> Presenting your regression results.</a></li>
<li class="chapter" data-level="8.10" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#rescaling-input-variables-to-assist-interpretation"><i class="fa fa-check"></i><b>8.10</b> Rescaling input variables to assist interpretation</a></li>
<li class="chapter" data-level="8.11" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#testing-conditional-hypothesis-interactions"><i class="fa fa-check"></i><b>8.11</b> Testing conditional hypothesis: interactions</a></li>
<li class="chapter" data-level="8.12" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#model-building-and-variable-selection"><i class="fa fa-check"></i><b>8.12</b> Model building and variable selection</a></li>
<li class="chapter" data-level="8.13" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#regression-assumptions"><i class="fa fa-check"></i><b>8.13</b> Regression assumptions</a><ul>
<li class="chapter" data-level="8.13.1" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#homework-4"><i class="fa fa-check"></i><b>8.13.1</b> HOMEWORK</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html"><i class="fa fa-check"></i><b>9</b> Week 9 : Spatial regression models</a><ul>
<li class="chapter" data-level="9.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#looking-at-the-residuals-and-testing-for-spatial-autocorrelation-in-regression"><i class="fa fa-check"></i><b>9.2</b> Looking at the residuals and testing for spatial autocorrelation in regression</a></li>
<li class="chapter" data-level="9.3" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#what-to-do-now"><i class="fa fa-check"></i><b>9.3</b> What to do now?</a></li>
<li class="chapter" data-level="9.4" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#spatial-regimes"><i class="fa fa-check"></i><b>9.4</b> Spatial Regimes</a><ul>
<li class="chapter" data-level="9.4.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#homework-1-4"><i class="fa fa-check"></i><b>9.4.1</b> HOMEWORK 1</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#lagrange-multipliers"><i class="fa fa-check"></i><b>9.5</b> Lagrange multipliers</a><ul>
<li class="chapter" data-level="9.5.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#homework-2-4"><i class="fa fa-check"></i><b>9.5.1</b> HOMEWORK 2</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#fitting-and-interpreting-a-spatially-lagged-model"><i class="fa fa-check"></i><b>9.6</b> Fitting and interpreting a spatially lagged model</a></li>
<li class="chapter" data-level="9.7" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#fitting-an-interpreting-a-spatial-error-model"><i class="fa fa-check"></i><b>9.7</b> Fitting an interpreting a spatial error model</a><ul>
<li class="chapter" data-level="9.7.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#homework-3-1"><i class="fa fa-check"></i><b>9.7.1</b> HOMEWORK 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i><b>10</b> Week 10</a><ul>
<li class="chapter" data-level="10.1" data-path="week-10.html"><a href="week-10.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="10.1.1" data-path="week-10.html"><a href="week-10.html#pro-tip-do-i-need-to-install-this-package"><i class="fa fa-check"></i><b>10.1.1</b> Pro-tip: do I need to install this package?</a></li>
<li class="chapter" data-level="10.1.2" data-path="week-10.html"><a href="week-10.html#data"><i class="fa fa-check"></i><b>10.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="week-10.html"><a href="week-10.html#interpreting-spatial-lag-coefficiences"><i class="fa fa-check"></i><b>10.2</b> Interpreting Spatial Lag Coefficiences</a></li>
<li class="chapter" data-level="10.3" data-path="week-10.html"><a href="week-10.html#mapping-rates-learning-from-disease-mapping"><i class="fa fa-check"></i><b>10.3</b> Mapping rates, learning from disease mapping</a></li>
<li class="chapter" data-level="10.4" data-path="week-10.html"><a href="week-10.html#binning"><i class="fa fa-check"></i><b>10.4</b> Binning</a><ul>
<li class="chapter" data-level="10.4.1" data-path="week-10.html"><a href="week-10.html#the-binning-process"><i class="fa fa-check"></i><b>10.4.1</b> The Binning Process</a></li>
<li class="chapter" data-level="10.4.2" data-path="week-10.html"><a href="week-10.html#different-binning-techniques"><i class="fa fa-check"></i><b>10.4.2</b> Different Binning Techniques</a></li>
<li class="chapter" data-level="10.4.3" data-path="week-10.html"><a href="week-10.html#homework-10.3"><i class="fa fa-check"></i><b>10.4.3</b> Homework 10.3</a></li>
<li class="chapter" data-level="10.4.4" data-path="week-10.html"><a href="week-10.html#multivariate-binning"><i class="fa fa-check"></i><b>10.4.4</b> Multivariate binning</a></li>
<li class="chapter" data-level="10.4.5" data-path="week-10.html"><a href="week-10.html#benefits-of-binning"><i class="fa fa-check"></i><b>10.4.5</b> Benefits of Binning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="week-10.html"><a href="week-10.html#a-final-note-of-caution-maup"><i class="fa fa-check"></i><b>10.5</b> A final note of caution: MAUP</a><ul>
<li class="chapter" data-level="10.5.1" data-path="week-10.html"><a href="week-10.html#what-is-maup"><i class="fa fa-check"></i><b>10.5.1</b> What is MAUP?</a></li>
<li class="chapter" data-level="10.5.2" data-path="week-10.html"><a href="week-10.html#why-does-maup-matter"><i class="fa fa-check"></i><b>10.5.2</b> Why does MAUP matter?</a></li>
<li class="chapter" data-level="10.5.3" data-path="week-10.html"><a href="week-10.html#what-can-we-do"><i class="fa fa-check"></i><b>10.5.3</b> What can we do?</a></li>
<li class="chapter" data-level="10.5.4" data-path="week-10.html"><a href="week-10.html#homework-10.4"><i class="fa fa-check"></i><b>10.5.4</b> Homework 10.4</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="week-10.html"><a href="week-10.html#references-and-further-reading"><i class="fa fa-check"></i><b>10.6</b> References and further reading</a><ul>
<li class="chapter" data-level="10.6.1" data-path="week-10.html"><a href="week-10.html#binning-1"><i class="fa fa-check"></i><b>10.6.1</b> Binning</a></li>
<li class="chapter" data-level="10.6.2" data-path="week-10.html"><a href="week-10.html#maup"><i class="fa fa-check"></i><b>10.6.2</b> MAUP</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Crime Mapping in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-5-studying-spatial-point-patterns" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Week 5 : Studying spatial point patterns</h1>
<div id="what-well-do-today" class="section level2">
<h2><span class="header-section-number">5.1</span> What we’ll do today</h2>
<p>We have now covered quite a bit. You’ve learnt about spatial objects and various formats in which they come and are stored by R, how to produce maps using a variety of packages, and also provided you with a brief introduction to common spatial operations. In what remains of the semester we are going to shift the emphasis and start focusing a bit more on spatial statistics. First we will focus on techniques that are used to explore and analyse points in a geographical space and in subsequent sessions we will cover techniques that are used to analyse spatial data when our unit of analysis are polygons (e.g., postal code areas, census areas, police beats, etc).</p>
<p>We will introduce a new R package called <strong>spatstat</strong>, that was developed for spatial point pattern analysis and modelling. It was written by Adrian Baddeley and Rolf Turner. There is a <a href="http://spatstat.org">webpage</a> dedicated to this package. The <a href="https://www.crcpress.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/p/book/9781482210200">thickest book</a> in my library, at 810 pages, is dedicated to this package. So as you can imagine the theory and practice of spatial pattern analysis is something one could devote an entire course to. You can get a pdf document used in a course the authors of this package develop <a href="https://research.csiro.au/software/wp-content/uploads/sites/6/2015/02/Rspatialcourse_CMIS_PDF-Standard.pdf">here</a>. In our course we are only going to provide you with an introductory practical entry into this field of techniques. If this package is not installed in your machine, make sure you install it before we carry on.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
<span class="kw">library</span>(tmap)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(spatstat)</code></pre>
</div>
<div id="getting-the-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Getting the data</h2>
<p>We will using the crime data from Greater Manchester police we have been using so far. Let’s focus on burglary in the Fallowfield area. The code below has already been explained and used in previous sessions, so we won’t go over the detail again. But rather than cut and paste automatically, try to remember what each line of code is doing.</p>
<p>By the way, the police data for Manchester we have used in previous sessions correspond to only one month of the year. Here we are using a full year worth of data, so the data import will take a bit longer.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Read a geojson file with Manchester wards</span>
manchester_ward &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;https://raw.githubusercontent.com/RUMgroup/Spatial-data-in-R/master/rumgroup/data/wards.geojson&quot;</span>)</code></pre>
<pre><code>## Reading layer `OGRGeoJSON&#39; from data source `https://raw.githubusercontent.com/RUMgroup/Spatial-data-in-R/master/rumgroup/data/wards.geojson&#39; using driver `GeoJSON&#39;
## Simple feature collection with 215 features and 12 fields
## geometry type:  POLYGON
## dimension:      XY
## bbox:           xmin: 351664 ymin: 381168.6 xmax: 406087.5 ymax: 421039.8
## epsg (SRID):    27700
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Create a new object that only has the city centre ward</span>
df1 &lt;-<span class="st"> </span>manchester_ward <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(wd16nm <span class="op">==</span><span class="st"> &quot;Fallowfield&quot;</span>)
<span class="co">#Change coordinate systems</span>
fallowfield &lt;-<span class="st"> </span><span class="kw">st_transform</span>(df1, <span class="dv">4326</span>)
<span class="co">#Get rid of objects we no longer need</span>
<span class="kw">rm</span>(manchester_ward)
<span class="kw">rm</span>(df1)

<span class="co">#Read Greater Manchester police data</span>
crimes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/jjmedinaariza/CrimeMapping/master/gmpcrime.csv&quot;</span>)
burglary &lt;-<span class="st"> </span><span class="kw">filter</span>(crimes, crime_type <span class="op">==</span><span class="st"> &quot;Burglary&quot;</span>)

<span class="co">#Transform the dataframe with crime information into a sf object</span>
burglary_spatial =<span class="st"> </span><span class="kw">st_as_sf</span>(burglary, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>), 
                 <span class="dt">crs =</span> <span class="dv">4326</span>, <span class="dt">agr =</span> <span class="st">&quot;constant&quot;</span>)

<span class="co">#Select only the crimes that take place within the space defined by the Ward boundaries</span>
<span class="co"># intersection</span>
bur_fal &lt;-<span class="st"> </span><span class="kw">st_intersects</span>(fallowfield, burglary_spatial)</code></pre>
<pre><code>## although coordinates are longitude/latitude, st_intersects assumes that they are planar</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># subsetting</span>
bur_fal &lt;-<span class="st"> </span>burglary_spatial[<span class="kw">unlist</span>(bur_fal),]
<span class="kw">rm</span>(crimes)
<span class="kw">rm</span>(burglary)

<span class="co">#Let&#39;s see the results</span>
<span class="kw">tm_shape</span>(fallowfield) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_shape</span>(bur_fal) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_dots</span>()</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>In the point pattern analysis literature each point is often referred to as an <strong>event</strong> and these events can have <strong>marks</strong>, attributes or characteristics that are also encoded in the data. In our spatial object one of these <em>marks</em> is the type of crime (altough in this case it’s of little interest since we have filtered on it).</p>
</div>
<div id="getting-the-data-into-spatstat-the-problem-with-duplicates" class="section level2">
<h2><span class="header-section-number">5.3</span> Getting the data into spatstat: the problem with duplicates</h2>
<p>So let’s start using spatstat.The first thing we need to do is to transform our sf object into a <strong>ppp</strong> object which is how spatstat likes to store its point patterns. Unfortunately, spatstat and many other packages for analysis of spatial data precede sf, so the transformation is a bit awkard. Also before we do that, it is important to realise that a point pattern is defined as a series of events in a given area, or window, of observation. It is therefore extremely important to precisely define this window. In <em>spatstat</em> the function <em>owin()</em> is used to set the observation window. However, the standard function takes the coordinates of a rectangle or of a polygon from a matrix, and therefore it may be a bit tricky to use. Luckily the package <em>maptools</em> provides a way to transform a SpatialPolygons into an object of class owin, using the function as.owin</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#First we transform our Falllowfield polygon into a sp object</span>
fallowfield_sp &lt;-<span class="kw">as</span>(fallowfield, <span class="st">&quot;Spatial&quot;</span>)
<span class="co">#Then we use the as.owin function to define the window</span>
window &lt;-<span class="st"> </span>maptools<span class="op">::</span><span class="kw">as.owin.SpatialPolygons</span>(fallowfield_sp)
<span class="co">#Check that this worked</span>
<span class="kw">class</span>(window)</code></pre>
<pre><code>## [1] &quot;owin&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">window</code></pre>
<pre><code>## window: polygonal boundary
## enclosing rectangle: [-2.2581074, -2.2141921] x [53.43904, 53.45145] units</code></pre>
<p>Now that we have created the window as an owin object let’s get the points:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#First we will extract the coordinates from our sf point data into a matrix</span>
sf_bur_fal_coords &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">unlist</span>(bur_fal<span class="op">$</span>geometry), <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)
<span class="co">#Then we use the ppp function to create the object using the information from our matrix and the window that we created</span>
bur_ppp &lt;-<span class="st"> </span><span class="kw">ppp</span>(<span class="dt">x =</span> sf_bur_fal_coords[,<span class="dv">1</span>], <span class="dt">y =</span> sf_bur_fal_coords[,<span class="dv">2</span>],
                   <span class="dt">window =</span> window, <span class="dt">check =</span> T)</code></pre>
<pre><code>## Warning: data contain duplicated points</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bur_ppp)</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Notice the warning message about duplicates. In spatial point pattern analysis an issue of significance is the presence of duplicates. The statistical methodology used for spatial point pattern processes is based largely on the assumption that processes are simple, that is, that the points cannot be coincident. That assumption may be unreasonable in many contexts (for example, the literature on repeat victimisation indeed suggests that we should expect the same households to be at a higher risk of being hit again). Even so the point (no pun intended) is that “when the data has coincidence points, some statistical procedures will be severely affected. So it is always strongly advisable to check for duplicate points and to decide on a strategy for dealing with them if they are present” (Baddeley et al., 2016: 60).</p>
<p>We can check the duplication in a ppp object with the following syntax:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">any</span>(<span class="kw">duplicated</span>(bur_ppp))</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>To count the number of coincidence points we use the multiplicity() function. This will return a vector of integers, with one entry for each observation in our dataset, giving the number of points that are identical to the point in question (including itself).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multiplicity</span>(bur_ppp)</code></pre>
<p>If you want to know how many locations have more than one event you can use:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">multiplicity</span>(bur_ppp) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</code></pre>
<pre><code>## [1] 190</code></pre>
<p>That’s quite something. 190 points out of 223 here share coordinates.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tm_shape</span>(fallowfield) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_shape</span>(bur_fal) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_dots</span>(<span class="dt">alpha=</span><span class="fl">0.4</span>, <span class="dt">size=</span><span class="dv">1</span>)</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>In the case of crime, as we have hinted some of this may be linked to the nature of crime itself. Hint: repeat victimisation. However, this pattern of duplication is fairly obvious across all crime categories in the police.uk website and, although I have not explored this in detail, I strongly suspect it is a function of the anonimisation process used to create these maps. The coordinates provided in the open data are not the exact locations of crimes, but they come from a list of points generated for purposes of data publication. You can see the details <a href="https://data.police.uk/about/#anonymisation">here</a>. This process is likely inflating the amount of duplication we observe. So keep in mind when analysing and working with this data that it is not the same as working with the real locations.</p>
<p>What to do about duplicates in spatial point pattern analysis is not always clear. You could simply delete the duplicates, but of course that may ignore issues such as repeat victimisation. You could also use jittering, which will add a small perturbation to the duplicate points so that they do not occupy the exact same space. Which again, may ignore things like repeat victimisation. Another alternative is to make each point “unique” and then attach the multiplicites of the points to the patterns as <em>marks</em>, as attributes of the points. Then you would need analytical techniques that take into account these marks.</p>
<p>If you were to be doing this for real you would want access to the real thing, not this public version of the data and then go for the second solution suggested above. We don’t have access to the source data, so for the sake of simplicity and so that we can illustrate how spatstat works we will add some jittering to the data. The first argument for the function is the object, retry asks whether we want the algorithm to have another go if the jittering places a point outside the window (we want this so that we don’t loose points), and the drop argument is used to ensure we get a ppp object as a result of running this function.</p>
<pre class="sourceCode r"><code class="sourceCode r">jitter_bur &lt;-<span class="st"> </span><span class="kw">rjitter</span>(bur_ppp, <span class="dt">retry=</span><span class="ot">TRUE</span>, <span class="dt">nsim=</span><span class="dv">1</span>, <span class="dt">drop=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(jitter_bur)</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Notice the difference with the original plot. Can you see how the circumferences do not overlap perfectly now?</p>
</div>
<div id="inspecting-our-data-with-spatstat" class="section level2">
<h2><span class="header-section-number">5.4</span> Inspecting our data with spatstat</h2>
<p>This package supports all kind of exploratory point pattern analysis. One example of this is quadrant counting. One could divide the window of observation into quadrants and count the number of points into each of these quadrants. For example, if we want four quadrants along the X axis and 3 along the Y axis we could used those parameters in the quadratcount() function. Then we just use standard plotting functions from R base.</p>
<pre class="sourceCode r"><code class="sourceCode r">Q &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(jitter_bur, <span class="dt">nx =</span> <span class="dv">4</span>, <span class="dt">ny =</span> <span class="dv">3</span>)
<span class="kw">plot</span>(jitter_bur)
<span class="kw">plot</span>(Q, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>In the video lectures by Luc Anselin would were exposed to the notion of complete spatial randomness (CSR). When we look at a point pattern process the first step in the process is whether it has been generated in a random manner. Under CSR, points are independent of each other and have the same propensity to be found at any location. We can generate data that conform to complete spatial randomness using the <em>rpoispp()</em> function. The r at the beginning is used to denote we are simulating data (you will this is common in R) and we are using a Poisson point process. Let’s generate 223 points in a random manner:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">rpoispp</span>(<span class="dv">223</span>))</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>You will notice that the points in a homogeneous Poisson process are not ‘uniformly spread’: there are empty gaps and clusters of points. Run the previous command a few times. You will see the map generated is different each time.</p>
<p>In classical literature, the homogeneous Poisson process (CSR) is usually taken as the appropriate ‘null’ model for a point pattern. Our basic task in analysing a point pattern is to find evidence against CSR. We can run a Chi Square test to check this. So, for example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quadrat.test</span>(jitter_bur, <span class="dt">nx =</span> <span class="dv">3</span>, <span class="dt">ny =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
##  Pearson X2 statistic
## 
## data:  jitter_bur
## X2 = 113.09, df = 5, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided
## 
## Quadrats: 6 tiles (irregular windows)</code></pre>
<p>Observing the results we see that the p value is well below convential standards for rejection of the null hypothesis. Observing data as the one we have for burglary in Fallowfield would be extremely rare if the null hypothesis was true. We can then conclude that the burglary data is not randomly distributed in the observed space. But no cop nor criminologist would really question this. We do know that crime is not randomly distributed in space.</p>
</div>
<div id="density-estimates" class="section level2">
<h2><span class="header-section-number">5.5</span> Density estimates</h2>
<p>In the presentations by Luc Anselin and the recommended reading materials we introduced the notion of density maps. Kernel density estimation involves applying a function (known as a “kernel”) to each data point, which averages the location of that point with respect to the location of other data points.</p>
<pre class="sourceCode r"><code class="sourceCode r">ds &lt;-<span class="st"> </span><span class="kw">density</span>(jitter_bur)
<span class="kw">class</span>(ds)</code></pre>
<pre><code>## [1] &quot;im&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ds, <span class="dt">main=</span><span class="st">&#39;Burglary density in Fallowfield&#39;</span>)</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>The density function is estimating a kernel density estimate. Density is nothing but the number of points per unit area. This method computes the intensity continuously across the study area and the object return is a raster image. To perform this analysis in R we need to define the bandwidth of the density estimation, which basically determines the area of influence of the estimation. There is no general rule to determine the correct bandwidth; generally speaking if h is too small the estimate is too noisy, while if h is too high the estimate may miss crucial elements of the point pattern due to oversmoothing (Scott, 2009).</p>
<p>The key argument to pass to the density method for point patterm objects is sigma=, which determines the bandwidth of the kernel. In spatstat the functions bw.diggle, bw.ppl, and bw.scott can be used to estimate the bandwidth according to difference methods. The helpfiles recommend the use of the first two. These functions run algorithms that aim to select an appropriate bandwith.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bw.diggle</span>(jitter_bur)</code></pre>
<pre><code>##        sigma 
## 4.249614e-05</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bw.ppl</span>(jitter_bur)</code></pre>
<pre><code>##        sigma 
## 0.0003616265</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bw.scott</span>(jitter_bur)</code></pre>
<pre><code>##     sigma.x     sigma.y 
## 0.004069941 0.000844521</code></pre>
<p>You can see the Diggle algorithm gives you the narrower bandwith. We can test how they work with our dataset using the following code:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(<span class="kw">density.ppp</span>(jitter_bur, <span class="dt">sigma =</span> <span class="kw">bw.diggle</span>(jitter_bur),<span class="dt">edge=</span>T),
     <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;h = 0.000003&quot;</span>))

<span class="kw">plot</span>(<span class="kw">density.ppp</span>(jitter_bur, <span class="dt">sigma =</span> <span class="kw">bw.ppl</span>(jitter_bur),<span class="dt">edge=</span>T),
     <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;h =0.0005&quot;</span>))

<span class="kw">plot</span>(<span class="kw">density.ppp</span>(jitter_bur, <span class="dt">sigma =</span> <span class="kw">bw.scott</span>(jitter_bur)[<span class="dv">2</span>],<span class="dt">edge=</span>T),
     <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;h = 0.0008&quot;</span>))

<span class="kw">plot</span>(<span class="kw">density.ppp</span>(jitter_bur, <span class="dt">sigma =</span> <span class="kw">bw.scott</span>(jitter_bur)[<span class="dv">1</span>],<span class="dt">edge=</span>T),
     <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;h = 0.004&quot;</span>))</code></pre>
<p><img src="05-week5_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Baddeley et (2016) suggest the use of the bw.ppl algorithm because in their experience it tends to produce the more appropriate values when the pattern consists predominantly of tight clusters. But they also insist that to detect a single tight cluster in the midst of random noise the bw.diggle method seems to work best.</p>
</div>
<div id="adding-some-context" class="section level2">
<h2><span class="header-section-number">5.6</span> Adding some context</h2>
<p>Often it is convenient to use a basemap to provide context. In order to do that we first need to turn the image object generated by the spatstat package into a raster object, a more generic format for raster image used in R.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## 
## Attaching package: &#39;raster&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:spatstat&#39;:
## 
##     area, rotate, shift</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     getData</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">dmap1 &lt;-<span class="st"> </span><span class="kw">density.ppp</span>(jitter_bur, <span class="dt">sigma =</span> <span class="kw">bw.ppl</span>(jitter_bur),<span class="dt">edge=</span>T)
r1 &lt;-<span class="st"> </span><span class="kw">raster</span>(dmap1)
<span class="co">#remove very low density values</span>
r1[r1 <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span> ] &lt;-<span class="st"> </span><span class="ot">NA</span>
<span class="kw">class</span>(r1)</code></pre>
<pre><code>## [1] &quot;RasterLayer&quot;
## attr(,&quot;package&quot;)
## [1] &quot;raster&quot;</code></pre>
<p>Now that we have the raster we can add it to a basemap.</p>
<p>Two-dimensional RasterLayer objects (from the raster package) can be turned into images and added to Leaflet maps using the addRasterImage function.</p>
<p>The addRasterImage function works by projecting the RasterLayer object to EPSG:3857 and encoding each cell to an RGBA color, to produce a PNG image. That image is then embedded in the map widget.</p>
<p>It’s important that the RasterLayer object is tagged with a proper coordinate reference system. Many raster files contain this information, but some do not. Here is how you’d tag a raster layer object “r” which contains WGS84 data:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(leaflet)

<span class="co">#make sure we have right CRS. We need the sp package for setting CRS to this raster: </span>
<span class="kw">library</span>(sp)
<span class="kw">crs</span>(r1) &lt;-<span class="st"> </span>sp<span class="op">::</span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot;</span>)

<span class="co">#we also create a colour palet</span>
pal &lt;-<span class="st"> </span><span class="kw">colorNumeric</span>(<span class="kw">c</span>(<span class="st">&quot;#0C2C84&quot;</span>, <span class="st">&quot;#41B6C4&quot;</span>, <span class="st">&quot;#FFFFCC&quot;</span>), <span class="kw">values</span>(r1),
  <span class="dt">na.color =</span> <span class="st">&quot;transparent&quot;</span>)

<span class="co">#and then make map!</span>
<span class="kw">leaflet</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">setView</span>(<span class="dt">lng =</span> <span class="fl">-2.225814</span>, <span class="dt">lat =</span> <span class="fl">53.441315</span>, <span class="dt">zoom =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">addRasterImage</span>(r1, <span class="dt">colors =</span> pal, <span class="dt">opacity =</span> <span class="fl">0.8</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">addLegend</span>(<span class="dt">pal =</span> pal, <span class="dt">values =</span> <span class="kw">values</span>(r1),
    <span class="dt">title =</span> <span class="st">&quot;Burglary map&quot;</span>)</code></pre>
<div id="htmlwidget-25e95795676f10ffc7cc" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-25e95795676f10ffc7cc">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[53.441315,-2.225814],14,[]],"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[53.4514517532155,-2.25810740373087],[53.4390428798791,-2.21419214050653]],0.8,null,null,null]},{"method":"addLegend","args":[{"colors":["#0C2C84 , #30619E 19.8638447380367%, #3E98B7 39.7276894764936%, #73C4C6 59.5915342149505%, #BDE1C9 79.4553789534074%, #FDFECC 99.3192236918643%, #FFFFCC "],"labels":["5,000,000","10,000,000","15,000,000","20,000,000","25,000,000"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"Burglary map","extra":{"p_1":0.198638447380367,"p_n":0.993192236918643},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[53.4390428798791,53.4514517532155],"lng":[-2.25810740373087,-2.21419214050653]}},"evals":[],"jsHooks":[]}</script>
<p>And therw you have it. Perhaps those familiar with Fallowfield have some guesses as to what may be going on there?</p>
<div id="homework-1-2" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Homework 1</h3>
<p>Ok, so see if you can do something like what we have done today, but for violent crime in the city centre. Produce the density estimates and then plot the density plot. In addition add a layer of points with the licenced premises we looked at last week.</p>
</div>
<div id="homework-2-2" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Homework 2</h3>
<p>Produce a kernel density estimate for burglary across the whole of the city. Where is burglary more concentrated?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4-performing-spatial-operations-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-6-spatial-autocorrelation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-week5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["CrimeMapping.pdf", "CrimeMapping.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
