<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Crime Mapping in R</title>
  <meta name="description" content="Worksheets for labs of Crime Mapping course">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Crime Mapping in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Worksheets for labs of Crime Mapping course" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Crime Mapping in R" />
  
  <meta name="twitter:description" content="Worksheets for labs of Crime Mapping course" />
  

<meta name="author" content="Juanjo Medina and Reka Solymosi">


<meta name="date" content="2019-02-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="week-6-spatial-autocorrelation.html">
<link rel="next" href="week-8-regression-analysis-a-refresher.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Crime mapping in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prelude</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>0.1</b> Introduction</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>0.2</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html"><i class="fa fa-check"></i><b>1</b> A first lesson about R (Week 1)</a><ul>
<li class="chapter" data-level="1.1" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#install-r-rstudio"><i class="fa fa-check"></i><b>1.1</b> Install R &amp; RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#open-up-and-explore-rstudio"><i class="fa fa-check"></i><b>1.2</b> Open up and explore RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#customising-the-rstudio-look"><i class="fa fa-check"></i><b>1.3</b> Customising the RStudio look</a></li>
<li class="chapter" data-level="1.4" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#getting-organised-r-projects"><i class="fa fa-check"></i><b>1.4</b> Getting organised: R Projects</a></li>
<li class="chapter" data-level="1.5" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#talk-to-your-computer"><i class="fa fa-check"></i><b>1.5</b> Talk to your computer</a></li>
<li class="chapter" data-level="1.6" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#more-on-packages"><i class="fa fa-check"></i><b>1.6</b> More on packages</a></li>
<li class="chapter" data-level="1.7" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#using-objects"><i class="fa fa-check"></i><b>1.7</b> Using objects</a></li>
<li class="chapter" data-level="1.8" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#more-on-objects"><i class="fa fa-check"></i><b>1.8</b> More on objects</a></li>
<li class="chapter" data-level="1.9" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#vectors"><i class="fa fa-check"></i><b>1.9</b> Vectors</a></li>
<li class="chapter" data-level="1.10" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#on-comments"><i class="fa fa-check"></i><b>1.10</b> On comments</a></li>
<li class="chapter" data-level="1.11" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#factors"><i class="fa fa-check"></i><b>1.11</b> Factors</a></li>
<li class="chapter" data-level="1.12" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#naming-conventions-for-objects-in-r"><i class="fa fa-check"></i><b>1.12</b> Naming conventions for objects in R</a></li>
<li class="chapter" data-level="1.13" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#dataframes"><i class="fa fa-check"></i><b>1.13</b> Dataframes</a></li>
<li class="chapter" data-level="1.14" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#exploring-data"><i class="fa fa-check"></i><b>1.14</b> Exploring data</a></li>
<li class="chapter" data-level="1.15" data-path="a-first-lesson-about-r-week-1.html"><a href="a-first-lesson-about-r-week-1.html#quitting-rstudio"><i class="fa fa-check"></i><b>1.15</b> Quitting RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html"><i class="fa fa-check"></i><b>2</b> Week 2: Making your first maps in R</a><ul>
<li class="chapter" data-level="2.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#a-quick-introduction-of-terms"><i class="fa fa-check"></i><b>2.1</b> A quick introduction of terms</a><ul>
<li class="chapter" data-level="2.1.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#geospatial-perspective---the-basics"><i class="fa fa-check"></i><b>2.1.1</b> Geospatial Perspective - The Basics</a></li>
<li class="chapter" data-level="2.1.2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#summary"><i class="fa fa-check"></i><b>2.1.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#getting-some-spatial-data-to-put-on-a-map"><i class="fa fa-check"></i><b>2.2</b> Getting some spatial data to put on a map</a><ul>
<li class="chapter" data-level="2.2.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#a-first-look-at-basemaps"><i class="fa fa-check"></i><b>2.2.1</b> A first look at basemaps</a></li>
<li class="chapter" data-level="2.2.2" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#find-some-relevant-data-to-show-obtaining-data-on-crime"><i class="fa fa-check"></i><b>2.2.2</b> Find some relevant data to show: obtaining data on crime</a></li>
<li class="chapter" data-level="2.2.3" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#add-a-point-layer-to-your-basemap"><i class="fa fa-check"></i><b>2.2.3</b> Add a point layer to your basemap</a></li>
<li class="chapter" data-level="2.2.4" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#homework-1"><i class="fa fa-check"></i><b>2.2.4</b> HOMEWORK 1</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#from-dataframes-to-spatial-objects-finding-shapefiles"><i class="fa fa-check"></i><b>2.3</b> From dataframes to spatial objects: finding shapefiles</a></li>
<li class="chapter" data-level="2.4" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#reading-shapefiles-into-r-the-wonderful-world-of-sf-objects"><i class="fa fa-check"></i><b>2.4</b> Reading shapefiles into R: the wonderful world of sf objects</a><ul>
<li class="chapter" data-level="2.4.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#homework-2"><i class="fa fa-check"></i><b>2.4.1</b> <strong>HOMEWORK 2</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#add-some-data"><i class="fa fa-check"></i><b>2.5</b> Add some data</a><ul>
<li class="chapter" data-level="2.5.1" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>2.5.1</b> Data wrangling with dplyr</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#join-data-to-spatial-object"><i class="fa fa-check"></i><b>2.6</b> Join data to spatial object</a></li>
<li class="chapter" data-level="2.7" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#so-left_join-eh"><i class="fa fa-check"></i><b>2.7</b> So left_join(), eh?</a></li>
<li class="chapter" data-level="2.8" data-path="week-2-making-your-first-maps-in-r.html"><a href="week-2-making-your-first-maps-in-r.html#lets-make-this-prettier-a-quick-glance-at-tmap"><i class="fa fa-check"></i><b>2.8</b> Let’s make this prettier: a quick glance at tmap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html"><i class="fa fa-check"></i><b>3</b> Week 3: Thematic maps in R</a><ul>
<li class="chapter" data-level="3.1" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#intro-and-recap"><i class="fa fa-check"></i><b>3.1</b> Intro and recap</a></li>
<li class="chapter" data-level="3.2" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#creating-choropleth-maps"><i class="fa fa-check"></i><b>3.2</b> Creating choropleth maps</a></li>
<li class="chapter" data-level="3.3" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#producing-small-multiples-to-compare-the-effect-of-different-classification-systems"><i class="fa fa-check"></i><b>3.3</b> Producing small multiples to compare the effect of different classification systems</a><ul>
<li class="chapter" data-level="3.3.1" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#homework-1-1"><i class="fa fa-check"></i><b>3.3.1</b> Homework 1</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#using-graduated-symbols"><i class="fa fa-check"></i><b>3.4</b> Using graduated symbols</a></li>
<li class="chapter" data-level="3.5" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#bringing-additional-census-data-in"><i class="fa fa-check"></i><b>3.5</b> Bringing additional census data in</a></li>
<li class="chapter" data-level="3.6" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#computing-and-mapping-crime-rates"><i class="fa fa-check"></i><b>3.6</b> Computing and mapping crime rates</a><ul>
<li class="chapter" data-level="3.6.1" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#homework-2-1"><i class="fa fa-check"></i><b>3.6.1</b> Homework 2</a></li>
<li class="chapter" data-level="3.6.2" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#homework-3"><i class="fa fa-check"></i><b>3.6.2</b> Homework 3</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="week-3-thematic-maps-in-r.html"><a href="week-3-thematic-maps-in-r.html#more-on-small-multiples-and-point-pattern-maps"><i class="fa fa-check"></i><b>3.7</b> More on small multiples and point pattern maps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html"><i class="fa fa-check"></i><b>4</b> Week 4: Performing spatial operations in R</a><ul>
<li class="chapter" data-level="4.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#getting-some-more-data"><i class="fa fa-check"></i><b>4.1</b> Getting some (more) data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#reading-data-in-from-the-web"><i class="fa fa-check"></i><b>4.1.1</b> Reading data in from the web</a></li>
<li class="chapter" data-level="4.1.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#subsetting-using-pattern-matching"><i class="fa fa-check"></i><b>4.1.2</b> Subsetting using pattern matching</a></li>
<li class="chapter" data-level="4.1.3" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#geocoding-from-an-address"><i class="fa fa-check"></i><b>4.1.3</b> Geocoding from an address</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#making-interactive-maps-with-leaflet"><i class="fa fa-check"></i><b>4.2</b> Making interactive maps with leaflet</a><ul>
<li class="chapter" data-level="4.2.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#making-a-map"><i class="fa fa-check"></i><b>4.2.1</b> Making a map</a></li>
<li class="chapter" data-level="4.2.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#adding-some-content"><i class="fa fa-check"></i><b>4.2.2</b> Adding some content:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#adding-points-manually"><i class="fa fa-check"></i><b>4.3</b> Adding points manually:</a><ul>
<li class="chapter" data-level="4.3.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#change-the-basemap"><i class="fa fa-check"></i><b>4.3.1</b> Change the basemap</a></li>
<li class="chapter" data-level="4.3.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#adding-data-from-elsewhere"><i class="fa fa-check"></i><b>4.3.2</b> Adding data from elsewhere</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#spatial-operations"><i class="fa fa-check"></i><b>4.4</b> Spatial operations</a><ul>
<li class="chapter" data-level="4.4.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#coordinate-reference-systems-revisited"><i class="fa fa-check"></i><b>4.4.1</b> Coordinate reference systems revisited</a></li>
<li class="chapter" data-level="4.4.2" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#meet-a-new-format-of-shapefile-geojson"><i class="fa fa-check"></i><b>4.4.2</b> Meet a new format of shapefile: geojson</a></li>
<li class="chapter" data-level="4.4.3" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#subset-points-to-those-within-a-polygon"><i class="fa fa-check"></i><b>4.4.3</b> Subset points to those within a polygon</a></li>
<li class="chapter" data-level="4.4.4" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#spatial-operations-two-building-buffers"><i class="fa fa-check"></i><b>4.4.4</b> Spatial operations two: building buffers</a></li>
<li class="chapter" data-level="4.4.5" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#points-in-polygon"><i class="fa fa-check"></i><b>4.4.5</b> Points in Polygon</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#recap"><i class="fa fa-check"></i><b>4.5</b> Recap</a></li>
<li class="chapter" data-level="4.6" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#homework"><i class="fa fa-check"></i><b>4.6</b> Homework</a><ul>
<li class="chapter" data-level="4.6.1" data-path="week-4-performing-spatial-operations-in-r.html"><a href="week-4-performing-spatial-operations-in-r.html#geocode-the-addresses"><i class="fa fa-check"></i><b>4.6.1</b> <strong>Geocode the addresses:</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html"><i class="fa fa-check"></i><b>5</b> Week 5 : Studying spatial point patterns</a><ul>
<li class="chapter" data-level="5.1" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#what-well-do-today"><i class="fa fa-check"></i><b>5.1</b> What we’ll do today</a></li>
<li class="chapter" data-level="5.2" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#getting-the-data"><i class="fa fa-check"></i><b>5.2</b> Getting the data</a></li>
<li class="chapter" data-level="5.3" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#getting-the-data-into-spatstat-the-problem-with-duplicates"><i class="fa fa-check"></i><b>5.3</b> Getting the data into spatstat: the problem with duplicates</a></li>
<li class="chapter" data-level="5.4" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#inspecting-our-data-with-spatstat"><i class="fa fa-check"></i><b>5.4</b> Inspecting our data with spatstat</a></li>
<li class="chapter" data-level="5.5" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#density-estimates"><i class="fa fa-check"></i><b>5.5</b> Density estimates</a></li>
<li class="chapter" data-level="5.6" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#adding-some-context"><i class="fa fa-check"></i><b>5.6</b> Adding some context</a><ul>
<li class="chapter" data-level="5.6.1" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#homework-1-2"><i class="fa fa-check"></i><b>5.6.1</b> Homework 1</a></li>
<li class="chapter" data-level="5.6.2" data-path="week-5-studying-spatial-point-patterns.html"><a href="week-5-studying-spatial-point-patterns.html#homework-2-2"><i class="fa fa-check"></i><b>5.6.2</b> Homework 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>6</b> Week 6 : Spatial autocorrelation</a><ul>
<li class="chapter" data-level="6.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#get-data"><i class="fa fa-check"></i><b>6.1</b> Get data</a></li>
<li class="chapter" data-level="6.2" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#what-is-a-neighbour"><i class="fa fa-check"></i><b>6.2</b> What is a neighbour?</a><ul>
<li class="chapter" data-level="6.2.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#homework-1-3"><i class="fa fa-check"></i><b>6.2.1</b> Homework 1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#creating-a-list-of-neighbours"><i class="fa fa-check"></i><b>6.3</b> Creating a list of neighbours</a></li>
<li class="chapter" data-level="6.4" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#generating-the-weight-matrix"><i class="fa fa-check"></i><b>6.4</b> Generating the weight matrix</a><ul>
<li class="chapter" data-level="6.4.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#homework-2-3"><i class="fa fa-check"></i><b>6.4.1</b> Homework 2</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#compute-morans-i"><i class="fa fa-check"></i><b>6.5</b> Compute Moran’s I</a><ul>
<li class="chapter" data-level="6.5.1" data-path="week-6-spatial-autocorrelation.html"><a href="week-6-spatial-autocorrelation.html#homework-3-optional-practice"><i class="fa fa-check"></i><b>6.5.1</b> Homework 3 (Optional Practice)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>7</b> Week 7 : Local spatial autocorrelation</a><ul>
<li class="chapter" data-level="7.1" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html#prelude-1"><i class="fa fa-check"></i><b>7.1</b> Prelude</a></li>
<li class="chapter" data-level="7.2" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html#get-data-and-built-the-weight-matrix"><i class="fa fa-check"></i><b>7.2</b> Get data and built the weight matrix</a></li>
<li class="chapter" data-level="7.3" data-path="week-7-local-spatial-autocorrelation.html"><a href="week-7-local-spatial-autocorrelation.html#generating-and-visualising-the-lisa-measures"><i class="fa fa-check"></i><b>7.3</b> Generating and visualising the LISA measures</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html"><i class="fa fa-check"></i><b>8</b> # Week 8 : Regression analysis (a refresher)</a><ul>
<li class="chapter" data-level="8.1" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#motivating-regression"><i class="fa fa-check"></i><b>8.2</b> Motivating regression</a></li>
<li class="chapter" data-level="8.3" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>8.3</b> Fitting a simple regression model</a></li>
<li class="chapter" data-level="8.4" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#residuals-revisited-r-squared"><i class="fa fa-check"></i><b>8.4</b> Residuals revisited: R squared</a></li>
<li class="chapter" data-level="8.5" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#inference-with-regression"><i class="fa fa-check"></i><b>8.5</b> Inference with regression</a></li>
<li class="chapter" data-level="8.6" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#fitting-regression-with-categorical-predictors"><i class="fa fa-check"></i><b>8.6</b> Fitting regression with categorical predictors</a></li>
<li class="chapter" data-level="8.7" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#motivating-multiple-regression"><i class="fa fa-check"></i><b>8.7</b> Motivating multiple regression</a></li>
<li class="chapter" data-level="8.8" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#fitting-and-interpreting-a-multiple-regression-model"><i class="fa fa-check"></i><b>8.8</b> Fitting and interpreting a multiple regression model</a></li>
<li class="chapter" data-level="8.9" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#presenting-your-regression-results."><i class="fa fa-check"></i><b>8.9</b> Presenting your regression results.</a></li>
<li class="chapter" data-level="8.10" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#rescaling-input-variables-to-assist-interpretation"><i class="fa fa-check"></i><b>8.10</b> Rescaling input variables to assist interpretation</a></li>
<li class="chapter" data-level="8.11" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#testing-conditional-hypothesis-interactions"><i class="fa fa-check"></i><b>8.11</b> Testing conditional hypothesis: interactions</a></li>
<li class="chapter" data-level="8.12" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#model-building-and-variable-selection"><i class="fa fa-check"></i><b>8.12</b> Model building and variable selection</a></li>
<li class="chapter" data-level="8.13" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#regression-assumptions"><i class="fa fa-check"></i><b>8.13</b> Regression assumptions</a><ul>
<li class="chapter" data-level="8.13.1" data-path="week-8-regression-analysis-a-refresher.html"><a href="week-8-regression-analysis-a-refresher.html#homework-4"><i class="fa fa-check"></i><b>8.13.1</b> HOMEWORK</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html"><i class="fa fa-check"></i><b>9</b> Week 9 : Spatial regression models</a><ul>
<li class="chapter" data-level="9.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#looking-at-the-residuals-and-testing-for-spatial-autocorrelation-in-regression"><i class="fa fa-check"></i><b>9.2</b> Looking at the residuals and testing for spatial autocorrelation in regression</a></li>
<li class="chapter" data-level="9.3" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#what-to-do-now"><i class="fa fa-check"></i><b>9.3</b> What to do now?</a></li>
<li class="chapter" data-level="9.4" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#spatial-regimes"><i class="fa fa-check"></i><b>9.4</b> Spatial Regimes</a><ul>
<li class="chapter" data-level="9.4.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#homework-1-4"><i class="fa fa-check"></i><b>9.4.1</b> HOMEWORK 1</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#lagrange-multipliers"><i class="fa fa-check"></i><b>9.5</b> Lagrange multipliers</a><ul>
<li class="chapter" data-level="9.5.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#homework-2-4"><i class="fa fa-check"></i><b>9.5.1</b> HOMEWORK 2</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#fitting-and-interpreting-a-spatially-lagged-model"><i class="fa fa-check"></i><b>9.6</b> Fitting and interpreting a spatially lagged model</a></li>
<li class="chapter" data-level="9.7" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#fitting-an-interpreting-a-spatial-error-model"><i class="fa fa-check"></i><b>9.7</b> Fitting an interpreting a spatial error model</a><ul>
<li class="chapter" data-level="9.7.1" data-path="week-9-spatial-regression-models.html"><a href="week-9-spatial-regression-models.html#homework-3-1"><i class="fa fa-check"></i><b>9.7.1</b> HOMEWORK 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i><b>10</b> Week 10</a><ul>
<li class="chapter" data-level="10.1" data-path="week-10.html"><a href="week-10.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="10.1.1" data-path="week-10.html"><a href="week-10.html#pro-tip-do-i-need-to-install-this-package"><i class="fa fa-check"></i><b>10.1.1</b> Pro-tip: do I need to install this package?</a></li>
<li class="chapter" data-level="10.1.2" data-path="week-10.html"><a href="week-10.html#data"><i class="fa fa-check"></i><b>10.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="week-10.html"><a href="week-10.html#interpreting-spatial-lag-coefficiences"><i class="fa fa-check"></i><b>10.2</b> Interpreting Spatial Lag Coefficiences</a></li>
<li class="chapter" data-level="10.3" data-path="week-10.html"><a href="week-10.html#mapping-rates-learning-from-disease-mapping"><i class="fa fa-check"></i><b>10.3</b> Mapping rates, learning from disease mapping</a></li>
<li class="chapter" data-level="10.4" data-path="week-10.html"><a href="week-10.html#binning"><i class="fa fa-check"></i><b>10.4</b> Binning</a><ul>
<li class="chapter" data-level="10.4.1" data-path="week-10.html"><a href="week-10.html#the-binning-process"><i class="fa fa-check"></i><b>10.4.1</b> The Binning Process</a></li>
<li class="chapter" data-level="10.4.2" data-path="week-10.html"><a href="week-10.html#different-binning-techniques"><i class="fa fa-check"></i><b>10.4.2</b> Different Binning Techniques</a></li>
<li class="chapter" data-level="10.4.3" data-path="week-10.html"><a href="week-10.html#homework-10.3"><i class="fa fa-check"></i><b>10.4.3</b> Homework 10.3</a></li>
<li class="chapter" data-level="10.4.4" data-path="week-10.html"><a href="week-10.html#multivariate-binning"><i class="fa fa-check"></i><b>10.4.4</b> Multivariate binning</a></li>
<li class="chapter" data-level="10.4.5" data-path="week-10.html"><a href="week-10.html#benefits-of-binning"><i class="fa fa-check"></i><b>10.4.5</b> Benefits of Binning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="week-10.html"><a href="week-10.html#a-final-note-of-caution-maup"><i class="fa fa-check"></i><b>10.5</b> A final note of caution: MAUP</a><ul>
<li class="chapter" data-level="10.5.1" data-path="week-10.html"><a href="week-10.html#what-is-maup"><i class="fa fa-check"></i><b>10.5.1</b> What is MAUP?</a></li>
<li class="chapter" data-level="10.5.2" data-path="week-10.html"><a href="week-10.html#why-does-maup-matter"><i class="fa fa-check"></i><b>10.5.2</b> Why does MAUP matter?</a></li>
<li class="chapter" data-level="10.5.3" data-path="week-10.html"><a href="week-10.html#what-can-we-do"><i class="fa fa-check"></i><b>10.5.3</b> What can we do?</a></li>
<li class="chapter" data-level="10.5.4" data-path="week-10.html"><a href="week-10.html#homework-10.4"><i class="fa fa-check"></i><b>10.5.4</b> Homework 10.4</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="week-10.html"><a href="week-10.html#references-and-further-reading"><i class="fa fa-check"></i><b>10.6</b> References and further reading</a><ul>
<li class="chapter" data-level="10.6.1" data-path="week-10.html"><a href="week-10.html#binning-1"><i class="fa fa-check"></i><b>10.6.1</b> Binning</a></li>
<li class="chapter" data-level="10.6.2" data-path="week-10.html"><a href="week-10.html#maup"><i class="fa fa-check"></i><b>10.6.2</b> MAUP</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Crime Mapping in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-7-local-spatial-autocorrelation" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Week 7 : Local spatial autocorrelation</h1>
<div id="prelude-1" class="section level2">
<h2><span class="header-section-number">7.1</span> Prelude</h2>
<p>Last week we learned about global measures of spatial association, in particular the Moran’s I statistic, which provide a mechanism to make inferences about a population from a sample. While this is useful for us to be able to assess quantitatively whether crime events cluster in a non-random manner, in the words of <a href="https://pdfs.semanticscholar.org/26d2/356618cd759d04348f1e51c8209b0175bfce.pdf">Jerry Ratcliffe</a> “this simply explains what most criminal justice students learn in their earliest classes.” For example, consider the study of robberies in Philadelphia:</p>
<p><img src="img/philly_rob.png" /></p>
<p>Aggregated to the police districts, this returns a global Moran’s I value (range 1 to 1) of 0.56, which suggests that police sectors with high robbery counts adjoin sectors that also have high robbery counts, and low crime sectors are often neighbors of other low crime sectors, something that should hardly be surprising given the above map <a href="https://pdfs.semanticscholar.org/26d2/356618cd759d04348f1e51c8209b0175bfce.pdf">(Ratcliffe, Jerry. “Crime mapping: spatial and temporal challenges.” Handbook of quantitative criminology. Springer, New York, NY, 2010. 5-24.)</a>.</p>
<p>In today’s session we will learn about local indicators of spatial association (LISA) and show how they allow for the decomposition of global indicators, such as Moran’s I, into the contribution of each observation. The LISA statistics serve two purposes. On one hand, they may be interpreted as indicators of local pockets of nonstationarity, or hot spots. On the other hand, they may be used to assess the influence of individual locations on the magnitude of the global statistic and to identify “outliers” <a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.1995.tb00338.x/full">(Anselin, Luc. “Local indicators of spatial association—LISA.” Geographical analysis 27.2 (1995): 93-115.)</a>.</p>
<p>These are the packages we will use:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" title="1"><span class="kw">library</span>(tmap)</a>
<a class="sourceLine" id="cb542-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb542-3" title="3"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb542-4" title="4"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb542-5" title="5"><span class="kw">library</span>(spdep)</a></code></pre></div>
</div>
<div id="get-data-and-built-the-weight-matrix" class="section level2">
<h2><span class="header-section-number">7.2</span> Get data and built the weight matrix</h2>
<p>For this week we will be going back to the data from last week about burglary in Manchester city. Below is the code to build this. This is code we have already used and covered in previous sessions. If any of this is confusing, or you need a reminder just refer to last week’s notes!</p>
<p>Get the boundary data:</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" title="1">shp_name &lt;-<span class="st"> &quot;data/BoundaryData/england_lsoa_2011.shp&quot;</span></a>
<a class="sourceLine" id="cb543-2" title="2">manchester_lsoa &lt;-<span class="st"> </span><span class="kw">st_read</span>(shp_name)</a></code></pre></div>
<pre><code>## Reading layer `england_lsoa_2011&#39; from data source `/Users/reka/Dropbox (The University of Manchester)/crimemapping_textbook_bookdown/data/BoundaryData/england_lsoa_2011.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 282 features and 3 fields
## geometry type:  POLYGON
## dimension:      XY
## bbox:           xmin: 378833.2 ymin: 382620.6 xmax: 390350.2 ymax: 405357.1
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs</code></pre>
<p>Transform the <em>CRS</em> to WGS84:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" title="1">lsoa_WGS84 &lt;-<span class="st"> </span><span class="kw">st_transform</span>(manchester_lsoa, <span class="dv">4326</span>)</a></code></pre></div>
<p>Read the crimes data into R:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" title="1">crimes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/jjmedinaariza/CrimeMapping/master/gmpcrime.csv&quot;</span>)</a></code></pre></div>
<p>Subset the <a href="data:Filter" class="uri">data:Filter</a> out to select burglary:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" title="1">burglary &lt;-<span class="st"> </span><span class="kw">filter</span>(crimes, crime_type <span class="op">==</span><span class="st"> &quot;Burglary&quot;</span>)</a></code></pre></div>
<p>Of course this is just a dataframe, and not (yet) a spatial object. To map, we must first transform into spatial object:</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb548-1" title="1">burglary_spatial &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(burglary, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>), </a>
<a class="sourceLine" id="cb548-2" title="2">                 <span class="dt">crs =</span> <span class="dv">4326</span>,                                            <span class="co">#set the CRS to WGS84</span></a>
<a class="sourceLine" id="cb548-3" title="3">                 <span class="dt">agr =</span> <span class="st">&quot;constant&quot;</span>)                                      <span class="co">#the &#39;agr&#39; attribute-geometry-relationship, specifies for each non-geometry attribute column how it relates to the geometry. &quot;constant&quot; is used for attributes that are constant throughout the geometry (e.g. land use)</span></a></code></pre></div>
<p>Now we want to select burglaries inside Manchester City. We can use <code>st_intersects()</code> to select those that intersect with the Manchester city LSOA map.</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1"><span class="co">#intersets</span></a>
<a class="sourceLine" id="cb549-2" title="2">bur_m &lt;-<span class="st"> </span><span class="kw">st_intersects</span>(lsoa_WGS84, burglary_spatial)</a></code></pre></div>
<pre><code>## although coordinates are longitude/latitude, st_intersects assumes that they are planar</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" title="1"><span class="co">#subsetting</span></a>
<a class="sourceLine" id="cb551-2" title="2">bur_m &lt;-<span class="st"> </span>burglary_spatial[<span class="kw">unlist</span>(bur_m),]</a></code></pre></div>
<p>Count the number of crimes in each LSOA by using the point in polygon spatial operation.</p>
<p>(remember this might take a while, it’s checking every single crime point, which you can see is over 400,000 points!)</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" title="1">burglaries_per_lsoa &lt;-<span class="st"> </span>bur_m <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb552-2" title="2"><span class="st">  </span><span class="kw">st_join</span>(lsoa_WGS84, ., <span class="dt">left =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb552-3" title="3"><span class="st">  </span><span class="kw">count</span>(code)</a></code></pre></div>
<pre><code>## although coordinates are longitude/latitude, st_intersects assumes that they are planar</code></pre>
<p>You can see the column with the count of burglaries is called ‘n’. (You can View() your data or use the names() function to check what your variables are called). This is not great variable naming, so let’s rename n into something more meaningful:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb554-1" title="1">burglaries_per_lsoa &lt;-<span class="st"> </span><span class="kw">rename</span>(burglaries_per_lsoa, <span class="dt">burglary =</span> n)</a></code></pre></div>
<p>Now that’s all our data wrangling done. Woo!</p>
<p>Let’s remove all the dataframes and objects we’ve read in but no longer need, now that we have arrived at our final dataset, <code>burglaries_per_lsoa</code>.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" title="1"><span class="co">#Remove redundant objects</span></a>
<a class="sourceLine" id="cb555-2" title="2"><span class="kw">rm</span>(burglary_spatial)</a>
<a class="sourceLine" id="cb555-3" title="3"><span class="kw">rm</span>(manchester_lsoa)</a>
<a class="sourceLine" id="cb555-4" title="4"><span class="co">#Remove redundant non spatial burglary objects</span></a>
<a class="sourceLine" id="cb555-5" title="5"><span class="kw">rm</span>(burglary)</a>
<a class="sourceLine" id="cb555-6" title="6"><span class="kw">rm</span>(crimes)</a></code></pre></div>
<p>And finally, let’s see our map! Plot with tmap:</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb556-1" title="1"><span class="kw">tm_shape</span>(burglaries_per_lsoa) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb556-2" title="2"><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&quot;burglary&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Reds&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb556-3" title="3"><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb556-4" title="4"><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">main.title =</span> <span class="st">&quot;Burglary counts&quot;</span>, <span class="dt">main.title.size =</span> <span class="fl">0.7</span> ,</a>
<a class="sourceLine" id="cb556-5" title="5">            <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>), <span class="dt">legend.title.size =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="07-week7_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Now that we have the data we need to coerce our newly created sf object into sp and then generate the wieght matrix. Again, what we do here is stuff we cover last week. In fact, if you did the optional homework you will also have run this code.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" title="1"><span class="co">#Coerce sf into sp</span></a>
<a class="sourceLine" id="cb557-2" title="2">burglary_m &lt;-<span class="st"> </span><span class="kw">as</span>(burglaries_per_lsoa, <span class="st">&quot;Spatial&quot;</span>)</a>
<a class="sourceLine" id="cb557-3" title="3"><span class="co">#Generate list of neighbours using the Queen criteria</span></a>
<a class="sourceLine" id="cb557-4" title="4">w &lt;-<span class="st"> </span><span class="kw">poly2nb</span>(burglary_m, <span class="dt">row.names=</span>burglary_m<span class="op">$</span>lsoa_code)</a>
<a class="sourceLine" id="cb557-5" title="5"><span class="co">#Generate list with weights using row standardisation</span></a>
<a class="sourceLine" id="cb557-6" title="6">ww &lt;-<span class="st">  </span><span class="kw">nb2listw</span>(w, <span class="dt">style=</span><span class="st">&#39;W&#39;</span>)</a></code></pre></div>
</div>
<div id="generating-and-visualising-the-lisa-measures" class="section level2">
<h2><span class="header-section-number">7.3</span> Generating and visualising the LISA measures</h2>
<p>The first step before we can generate the LISA map is to compute the local Moran’s I. The initial part of the video presentation by Luc Anselin that we expected you to watch explains the formula and logic underpinning these computations and we won’t reiterate here that detail. But at least a a general reminder:</p>
<p><em>“global tests for spatial autocorrelation introduced last week are calculated from the local relationship between the values observed at a spatial entity and its neighbours, for the neighbourhood definition chosen. Because of this, we can break global measures down into their components, and by extension, construct localised tests intended to detect <strong>‘clusters’</strong> -observations with very similar neighbours- and”</em> <strong>spatial outliers</strong> <em>“observations with very different neighbours”</em> (Bivand et al. 201)</p>
<p>Let’s first look at the Moran’s scatterplot:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb558-1" title="1"><span class="kw">moran.plot</span>(burglary_m<span class="op">$</span>burglary, ww)</a></code></pre></div>
<p><img src="07-week7_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Notice how the plot is split in 4 quadrants. The top right corner belongs to areas that have high level of burglary and are surrounded by other areas that have above the average level of burglary. This are the high-high locations that Luc Anselin referred to. The bottom left corner belongs to the low-low areas. These are areas with low level of burglary and surrounded by areas with below average levels of burglary. Both the high-high and low-low represent clusters. A high-high cluster is what you may refer to as a hot spot. And the low-low clusters represent cold spots. In the opposite diagonal we have <em>spatial outliers</em>. They are not outliers in the standard sense, extreme observations, they are outliers in that they are surrounded by areas that are very unlike them. So you could have high-low spatial outliers, areas with high levels of burglary and low levels of surrounding burglary, or low-high spatial outliers, areas that have themselves low levels of burglary (or whatever else we are mapping) and that are surrounded by areas with above average levels of burglary.</p>
<p>You can also see here that the positive spatial autocorrelation is more noticeable when we focus on the whole of Manchester city, unlike what we observed when only looked at Manchester city. You can check this running the global Moran’s I.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" title="1"><span class="kw">moran</span>(burglary_m<span class="op">$</span>burglary, ww, <span class="dt">n=</span><span class="kw">length</span>(ww<span class="op">$</span>neighbours), <span class="dt">S0=</span><span class="kw">Szero</span>(ww))</a></code></pre></div>
<pre><code>## $I
## [1] 0.319477
## 
## $K
## [1] 33.59689</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" title="1"><span class="kw">moran.mc</span>(burglary_m<span class="op">$</span>burglary, ww, <span class="dt">nsim=</span><span class="dv">99999</span>)</a></code></pre></div>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  burglary_m$burglary 
## weights: ww  
## number of simulations + 1: 1e+05 
## 
## statistic = 0.31948, observed rank = 1e+05, p-value = 1e-05
## alternative hypothesis: greater</code></pre>
<p>You can see that the global Moran’s is 0.32 and that is highly significant. There is indeed global spatial autocorrelation. Knowing this we can try to decompose this, figure out what is driving this global measure.</p>
<p>To compute the local Moran we can use a function from the <em>spdep</em> package.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" title="1">locm_bm &lt;-<span class="st"> </span><span class="kw">localmoran</span>(burglary_m<span class="op">$</span>burglary, ww)</a>
<a class="sourceLine" id="cb563-2" title="2"><span class="kw">summary</span>(locm_bm)</a></code></pre></div>
<pre><code>##        Ii                 E.Ii               Var.Ii       
##  Min.   :-1.933870   Min.   :-0.003559   Min.   :0.07787  
##  1st Qu.:-0.004654   1st Qu.:-0.003559   1st Qu.:0.14505  
##  Median : 0.123084   Median :-0.003559   Median :0.17460  
##  Mean   : 0.319477   Mean   :-0.003559   Mean   :0.17805  
##  3rd Qu.: 0.314142   3rd Qu.:-0.003559   3rd Qu.:0.21894  
##  Max.   :13.201230   Max.   :-0.003559   Max.   :0.44062  
##       Z.Ii            Pr(z &gt; 0)     
##  Min.   :-4.12540   Min.   :0.0000  
##  1st Qu.:-0.00256   1st Qu.:0.2202  
##  Median : 0.29992   Median :0.3821  
##  Mean   : 0.84062   Mean   :0.3707  
##  3rd Qu.: 0.77152   3rd Qu.:0.5010  
##  Max.   :37.50929   Max.   :1.0000</code></pre>
<p>The first column provides the summary statistic for the local moran statistic. Being local you will have one for each of the areas. The last column gives you a p value for this statistic. In order to produce the LISA map we need to do some previous work. First we are going to create some new variables that we are going to need:</p>
<p>First we scale the variable of interest. When we scale burglary what we are doing is re-scaling the values so that the mean is zero. See an explanation of what this does <a href="http://www.gastonsanchez.com/visually-enforced/how-to/2014/01/15/Center-data-in-R/">here</a>.</p>
<p>We use <code>scale()</code>, which is a generic function whose default method centers and/or scales the variable. Here centering is done by subtracting the mean (omitting NAs) the corresponding columns, and scaling is done by dividing the (centered) variable by their standard deviations:</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" title="1"><span class="co">#scale the variable of interest and save it to a new column</span></a>
<a class="sourceLine" id="cb565-2" title="2">burglary_m<span class="op">$</span>S_burglary &lt;-<span class="st"> </span><span class="kw">scale</span>(burglary_m<span class="op">$</span>burglary) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.vector</span>()</a></code></pre></div>
<p>We’ve also added <code>as.vector()</code> to the end, because</p>
<p>Now we also want to account for the spatial dependence of our values. Remember how we keep saying about “The First Law of Geography”, according to <a href="https://en.wikipedia.org/wiki/Waldo_R._Tobler">Waldo Tobler</a>, is “everything is related to everything else, but near things are more related than distant things.”</p>
<p>So what do we mean by this spatial dependence? When a value observed in one location depends on the values observed at neighboring locations, there is a <strong>spatial dependence</strong>. And spatial data may show spatial dependence in the variables and error terms.</p>
<p><em>Why should spatial dependence occur?</em> There are two reasons commonly given. First, data collection of observations associated with spatial units may reflect measurement error. This happens when the boundaries for which information is collected do not accurately reflect the nature of the underlying process generating the sample data. A second reason for spatial dependence is that the spatial dimension of a social or economic characteristic may be an important aspect of the phenomenon. For example, based on the premise that location and distance are important forces at work, regional science theory relies on notions of spatial interaction and diffusion effects, hierarchies of place and spatial spillovers.</p>
<p>There are two types of dependence, spatial error and spatial lag. Here we focus on spatial lag.</p>
<p><strong>Spatial lag</strong> is when the dependent variable y in place i is affected by the independent variables in both place i and j.</p>
<p><img src="img/spatial_lag.png" /></p>
<p>This will be important to keep in mind when considering spatial regression. With spatial lag in ordinary least square regression, the assumption of uncorrelated error terms is violated, becasuse near things will have associated error terms. Similarly, the assumption of independent observations is also violated, as the observations are influenced by the other observations near them. As a result, the estimates are biased and inefficient. Spatial lag is suggestive of a possible diffusion process – events in one place predict an increased likelihood of similar events in neighboring places.</p>
<p>So to be able to account for the spatial lag in our model, we must create a variable to account for this. We can do this with the <code>lag.listw()</code> function. Remember from last week: a spatial lag in this context is simply the average value of the burglary count in the areas that are considered neighours of each LSOA. So we are plotting the value of burglary against the average value of burglary in the neighbours.</p>
<p>For this we need our listw object, which is the <code>ww</code> object created earlier, when we generated the list with weights using row standardisation. We then pass this listw object into the <code>lag.listw()</code> function, which computes the spatial lag of a numeric vector using a listw sparse representation of a spatial weights matrix.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" title="1"><span class="co">#create a spatial lag variable and save it to a new column</span></a>
<a class="sourceLine" id="cb566-2" title="2">burglary_m<span class="op">$</span>lag_s_burglary &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(ww, burglary_m<span class="op">$</span>S_burglary)</a></code></pre></div>
<p>Make sure to check the summaries to ensure nothing weird is going on</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" title="1"><span class="kw">summary</span>(burglary_m<span class="op">$</span>S_burglary)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -1.2149 -0.6048 -0.1908  0.0000  0.2667  9.0256</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" title="1"><span class="kw">summary</span>(burglary_m<span class="op">$</span>lag_s_burglary)</a></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -0.99700 -0.44086 -0.07464  0.06068  0.34738  3.38679</code></pre>
<p>We can create a Moran scatter plot so that you see that nothing has changed apart from the scale in wich we are using the variables. The observations that are influential are higlighted in the plot as you can see.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" title="1">x &lt;-<span class="st"> </span>burglary_m<span class="op">$</span>S_burglary</a>
<a class="sourceLine" id="cb571-2" title="2">y &lt;-<span class="st"> </span>burglary_m<span class="op">$</span>lag_s_burglary</a>
<a class="sourceLine" id="cb571-3" title="3">xx &lt;-<span class="st"> </span><span class="kw">data_frame</span>(x,y)</a>
<a class="sourceLine" id="cb571-4" title="4"><span class="kw">moran.plot</span>(x, ww)</a></code></pre></div>
<p><img src="07-week7_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>We are now going to create a new variable to identify the quadrant in which each observation falls within the Moran Scatter plot, so that we can tell apart the high-high, low-low, high-low, and low-high areas. We will only identify those that are significant according to the p value that was provided by the local moran function.</p>
<p>Before we get started, let’s quickly review the tools we will use.</p>
<p>All our data is in this <code>burglary_m</code> dataframe. This has a variable for the LSOA code (<code>code</code>), a variable for the number of burglaries (<code>burglary</code>), and then also the two variables we created, the scaled measure of burglary (<code>S_burglary</code>), and the spatial lag measure (<code>lag_s_burglary</code>).</p>
<p>We also have our <code>locm_bm</code> object, which we created with the <code>localmoran()</code> function, that has calculated a variety of measures for each of our observations, which we explored with the <code>summary()</code> function. You can see (if you scroll up) that the 5th element in this object is the p-value (“Pr(z &gt; 0)”). To call the nth element of an object, you can use the square brackets after its name. So to return the nth column of thing, you can use <code>thing[,n]</code>. Again this should not be new to you, as we’ve been doing this sort of thing for a while.</p>
<p>So the data we need for each observation, in order to identify whether it belongs to the high-high, low-low, high-low, or low-high quadrants are the standardised burglary score, the spatial lag score, and the p-value.</p>
<p>Essentially all we’ll be doing, is assigning a variable values based on where in the plot it is. So for example, if it’s in the upper right, it is high-high, and has values larger than 0 for both the burglary and the spatial lag values. It it’s in the upper left, it’s low-hih, and has a value larger than 0 for the spatial lag value, but lower than 0 on the burglary value. And so on, and so on. Here’s an image to illustrate:</p>
<p><img src="img/moran_plot_annotate.png" /></p>
<p>So let’s first initialise this variable. In this instance we are creating a new column in the <code>burglary_m</code> dataframe and calling it <code>quad_sig</code>.</p>
<p>We are using the <code>mutate()</code> function from the tidyverse package to create our new variable, just as we have in previous labs.</p>
<p>We also use nested ifelse() statements. Nested ifelse() just means that it’s an ifelse() inside and ifelse() statement. To help us with these sorts of situations is the <code>ifelse()</code> function. We saw this with the previous exercises, but I’ll describe it brielfy again. It allows us to conditionally assign some value to some variable. The structure of the function is so that you have to pass it a condition, then a value to assign if the condition is true, and then another value if the condition is false. You are basically using this function to say: “if this condition is true, do first thing, else, do the second thing”. It would look something like this:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb572-1" title="1">dataframe<span class="op">$</span>new_variable &lt;-<span class="st"> </span><span class="kw">ifelse</span>(dataframe<span class="op">$</span>some_numeric_var <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;smaller than 100&quot;</span>, <span class="st">&quot;not smaller than 100&quot;</span>)</a></code></pre></div>
<p>When nesting these, all you do is put another condition to check in the “thing to do if false”, so it checks all conditions. So in the first instance we check if the value for burglary is greater than zero, and the value for the lag is greater than zero, and the p-value is smaller than our threshol of 0.05. If it is, then this should belong to the “high-high” group. If any one of these conditions is not met, then we move into the ‘thing to do if false’ section, where we now check agains another set of criteria, and so on and so on. If none of these are met, we assign it the non-significant value:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" title="1">burglary_m &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(burglary_m) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">quad_sig =</span> <span class="kw">ifelse</span>(burglary_m<span class="op">$</span>S_burglary <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-3" title="3"><span class="st">                                         </span>burglary_m<span class="op">$</span>lag_s_burglary <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-4" title="4"><span class="st">                                         </span>locm_bm[,<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb573-5" title="5">                     <span class="st">&quot;high-high&quot;</span>,</a>
<a class="sourceLine" id="cb573-6" title="6">                     <span class="kw">ifelse</span>(burglary_m<span class="op">$</span>S_burglary <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-7" title="7"><span class="st">                              </span>burglary_m<span class="op">$</span>lag_s_burglary <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-8" title="8"><span class="st">                              </span>locm_bm[,<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb573-9" title="9">                     <span class="st">&quot;low-low&quot;</span>, </a>
<a class="sourceLine" id="cb573-10" title="10">                     <span class="kw">ifelse</span>(burglary_m<span class="op">$</span>S_burglary <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-11" title="11"><span class="st">                              </span>burglary_m<span class="op">$</span>lag_s_burglary <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-12" title="12"><span class="st">                              </span>locm_bm[,<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb573-13" title="13">                     <span class="st">&quot;high-low&quot;</span>,</a>
<a class="sourceLine" id="cb573-14" title="14">                     <span class="kw">ifelse</span>(burglary_m<span class="op">$</span>S_burglary <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-15" title="15"><span class="st">                              </span>burglary_m<span class="op">$</span>lag_s_burglary <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-16" title="16"><span class="st">                              </span>locm_bm[,<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb573-17" title="17">                     <span class="st">&quot;low-high&quot;</span>, </a>
<a class="sourceLine" id="cb573-18" title="18">                     <span class="st">&quot;non-significant&quot;</span>)))))</a></code></pre></div>
<p>(Note we had to wrap our data in a <code>st_as_sf()</code> function, to covert back to sf object).</p>
<p>Now we can have a look at what this returns us:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" title="1"><span class="kw">table</span>(burglary_m<span class="op">$</span>quad_sig)</a></code></pre></div>
<pre><code>## 
##       high-high         low-low non-significant 
##              22               1             259</code></pre>
<p>This looks like a lot of non-significant results. We want to be sure this isn’t an artefact of our code but is true, we can check how many values are under 0.05:</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb576-1" title="1"><span class="kw">nrow</span>(locm_bm[locm_bm[,<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>,])</a></code></pre></div>
<pre><code>## [1] 23</code></pre>
<p>We can see that only 23 areas have p-values under 0.05 threshold. So this is in line with our results, and we can rest assured.</p>
<p>Well, this is exciting, but where are these regions?</p>
<p>Let’s put ’em on a map, just simply, using quick thematic map (<code>qtm()</code>):</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb578-1" title="1"><span class="kw">qtm</span>(burglary_m, <span class="dt">fill=</span><span class="st">&quot;quad_sig&quot;</span>, <span class="dt">fill.title=</span><span class="st">&quot;LISA&quot;</span>)</a></code></pre></div>
<pre><code>## Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
<p><img src="07-week7_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Very nice!</p>
<p><img src="https://media.giphy.com/media/Is1O1TWV0LEJi/giphy.gif" /></p>
<p>So how do we interpret these results? Well keep in mind:</p>
<ul>
<li>The LISA value for each location is determined from its individual contribution to the global Moran’s I calculation.</li>
<li>Whether or not this value is statistically significant is assessed by comparing the actual value to the value calculated for the same location by randomly reassigning the data among all the areal units and recalculating the values each time (the Monte Carlo simulation approach discussed earlier).</li>
</ul>
<p>So essentially this map now tells us that there was statistically significant moderate clustering in burglaries in Manchester. When reporting your results, report at least the Moran’s I test value and the p value. So, for this test, you should report Moran’s I = 0.32, p &lt; .001. Including the LISA cluster map is also a great way of showing how the attribute is actually clustering.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-6-spatial-autocorrelation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-8-regression-analysis-a-refresher.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-week7.Rmd",
"text": "Edit"
},
"download": ["CrimeMapping.pdf", "CrimeMapping.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
